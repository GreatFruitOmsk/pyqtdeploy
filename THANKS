Thanks to Ilya Kulakov <kulakov.ilya@gmail.com> for many bug reports,
suggestions and patches, particularly for Windows.
